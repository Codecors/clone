<html>
<head>
<script src="/socket.io/socket.io.js"></script>
<script>

var urlarr = window.location.href.split("/");
var server = urlarr[0] + "//" + urlarr[2]
var socket = io.connect(server);

var registeredParticipants = [];

socket.on('newuser', function (data) {
    // new user with particpant id = data.pid
    registeredParticipants.push([data.pid, data.guid]);
    loadUsers();
});

//
function loadUsers(){
    var select = document.getElementById('participantid');
    // clear
    while (select.firstChild) {
        select.removeChild(select.firstChild);
    }
    // add
    for (var i=0; i<registeredParticipants.length; i++){
        var opt = document.createElement('option');
        opt.value = registeredParticipants[i][1];
        opt.innerHTML = registeredParticipants[i][0];
        select.appendChild(opt);
    }

}

function moveToWheel(){
    var user = document.getElementById('participantid');
    var guid = user.value;
    var pid = user.innerHTML;
    socket.emit('static', { "url": "/wheel", "guid": guid, "pid": pid});
}

function moveToDial(){
    var user = document.getElementById('participantid');
    var guid = user.value;
    var pid = user.innerHTML;
    socket.emit('static', { "url": "/dial", "guid": guid, "pid": pid });
}

</script>
</head>

<body>

<h2>Wheel/dial selector</h2>
<hr>
<p>Participant:
    <select id='participantid'>
        <!-- options added dynamically as they register -->
    </select>
    <button onclick="moveToWheel()">Wheel</button>
    <button onclick="moveToDial()">Dial</button>
</p>

</body>
